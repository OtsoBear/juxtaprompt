import{r as e,R as s,j as t,e as r,a6 as n}from"./react-vendor-3434733a.js";import{u as o,D as i,s as a}from"./services-f69c01bc.js";import{P as c,D as l}from"./components-cea5a08e.js";import{l as d,o as m,b as p,g as u}from"./llm-services-bfcb06ee.js";import{l as f,B as g,A as h,e as x,m as v,D as j,n as y,o as b,p as w,q as k}from"./ui-components-c4033db8.js";import"./ui-vendor-6552b7df.js";import"./vendor-1309a697.js";import"./validation-a5e6ff80.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)}).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();const C={},N=s.lazy(()=>function(e,s,t){if(!s||0===s.length)return e();const r=document.getElementsByTagName("link");return Promise.all(s.map(e=>{if((e=function(e){return"/juxtaprompt/"+e}(e))in C)return;C[e]=!0;const s=e.endsWith(".css"),n=s?'[rel="stylesheet"]':"";if(t)for(let t=r.length-1;t>=0;t--){const n=r[t];if(n.href===e&&(!s||"stylesheet"===n.rel))return}else if(document.querySelector(`link[href="${e}"]${n}`))return;const o=document.createElement("link");return o.rel=s?"stylesheet":"modulepreload",s||(o.as="script",o.crossOrigin=""),o.href=e,document.head.appendChild(o),s?new Promise((s,t)=>{o.addEventListener("load",s),o.addEventListener("error",()=>t(new Error(`Unable to preload CSS for ${e}`)))}):void 0})).then(()=>e()).catch(e=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=e,window.dispatchEvent(s),!s.defaultPrevented)throw e})}(()=>import("./components-cea5a08e.js").then(e=>e.i),["assets/components-cea5a08e.js","assets/react-vendor-3434733a.js","assets/ui-vendor-6552b7df.js","assets/vendor-1309a697.js","assets/ui-components-c4033db8.js","assets/services-f69c01bc.js","assets/llm-services-bfcb06ee.js","assets/validation-a5e6ff80.js"]).then(e=>({default:e.LLMConfigurationPanel}))),P=()=>{const[n,C]=e.useState(()=>{const e=o.loadStateFromURL();return{prompts:(null==e?void 0:e.prompts.map((e,s)=>({id:`prompt-${s}`,content:e,createdAt:Date.now(),updatedAt:Date.now()})))||[{id:"prompt-1",content:"",createdAt:Date.now(),updatedAt:Date.now()},{id:"prompt-2",content:"",createdAt:Date.now(),updatedAt:Date.now()}],responses:[],config:null,ui:{...i,...(null==e?void 0:e.ui)&&Object.fromEntries(Object.entries(e.ui).filter(([,e])=>void 0!==e))},isLoading:!1,error:null}}),[P,E]=e.useState(!1),{theme:L,resolvedTheme:I,toggleTheme:S}=((s="system",t)=>{const[r,n]=e.useState(s),[o,i]=e.useState("light");e.useEffect(()=>{const e=window.matchMedia("(prefers-color-scheme: dark)"),s=()=>{i(e.matches?"dark":"light")};return s(),e.addEventListener("change",s),()=>{e.removeEventListener("change",s)}},[]);const a="system"===r?o:r;e.useEffect(()=>{const e=document.documentElement;e.classList.remove("light","dark"),e.classList.add(a),e.setAttribute("data-theme",a)},[a]);const c=e.useCallback(e=>{n(e),null==t||t(e)},[t]),l=e.useCallback(()=>{c("system"===r?"dark"===o?"light":"dark":"light"===r?"dark":"light")},[r,o,c]);return{theme:r,resolvedTheme:a,setTheme:c,toggleTheme:l}})(n.ui.theme,e=>{M({theme:e})});e.useEffect(()=>(d.registerProvider(m),d.registerProvider(p),d.registerProvider(u),()=>{d.cancelAllRequests()}),[]),e.useEffect(()=>{(()=>{const e=["openai","anthropic","gemini"];for(const s of e){const e=a.getAPIKey(s);if(e){const t={...l[s],apiKey:e},r=d.validateConfig(s,t);if(r.success){C(e=>({...e,config:r.data}));break}a.clearAPIKey(s)}}})()},[]),e.useEffect(()=>{if(n.prompts.length>0||n.config){const e={prompts:n.prompts.map(e=>e.content).filter(e=>e.trim().length>0),config:n.config?{provider:n.config.provider,model:n.config.model,temperature:n.config.temperature,maxTokens:n.config.maxTokens,topP:n.config.topP,frequencyPenalty:n.config.frequencyPenalty,presencePenalty:n.config.presencePenalty,systemMessage:n.config.systemMessage}:{},ui:n.ui};o.saveStateToURL(e)}},[n.prompts,n.config,n.ui]);const A=e.useCallback((e="",s)=>{const t={id:`prompt-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,content:e,...void 0!==s&&{title:s},createdAt:Date.now(),updatedAt:Date.now()};C(e=>({...e,prompts:[...e.prompts,t]}))},[]),D=e.useCallback((e,s,t)=>{C(r=>({...r,prompts:r.prompts.map(r=>r.id===e?{...r,content:s,...void 0!==t&&{title:t},updatedAt:Date.now()}:r)}))},[]),R=e.useCallback(e=>{C(s=>({...s,prompts:s.prompts.filter(s=>s.id!==e),responses:s.responses.filter(s=>s.promptId!==e)}))},[]),q=e.useCallback(()=>{C(e=>({...e,prompts:[],responses:[]}))},[]),T=e.useCallback(e=>{C(s=>({...s,config:e})),a.saveAPIKey(e.provider,e.apiKey)},[]),M=e.useCallback(e=>{C(s=>({...s,ui:{...s.ui,...e}}))},[]),O=e.useCallback(e=>{C(s=>({...s,error:e}))},[]),$=e.useCallback(()=>{C(e=>({...e,responses:[]}))},[]),U=e.useCallback(async e=>{if(!n.config)return void O("No LLM configuration available");const s=n.prompts.find(s=>s.id===e);if(s&&s.content.trim()){C(s=>({...s,responses:s.responses.filter(s=>s.promptId!==e),error:null}));try{const e=d.createRequest(s.content,n.config);if(!e.success)throw new Error(`Invalid request: ${e.error.message}`);const r=e.data;let o="";try{for await(const e of d.sendStreamingRequest(r))if(e.content&&(o+=e.content,C(t=>{const i=t.responses.findIndex(e=>e.promptId===s.id),a={id:`response-${s.id}`,promptId:s.id,response:{requestId:r.id,content:o,isComplete:e.isComplete,isStreaming:!e.isComplete,metadata:{...void 0!==e.tokenCount&&{tokenCount:e.tokenCount},model:n.config.model,provider:n.config.provider,timestamp:Date.now()}},createdAt:Date.now()};if(i>=0){const e=[...t.responses];return e[i]=a,{...t,responses:e}}return{...t,responses:[...t.responses,a]}})),e.isComplete)break}catch(t){const e={id:`response-${s.id}`,promptId:s.id,response:{requestId:r.id,content:"",isComplete:!0,isStreaming:!1,error:{code:"STREAMING_ERROR",message:t instanceof Error?t.message:"Unknown streaming error",retryable:!0},metadata:{model:n.config.model,provider:n.config.provider,timestamp:Date.now()}},createdAt:Date.now()};C(t=>{const r=t.responses.findIndex(e=>e.promptId===s.id);if(r>=0){const s=[...t.responses];return s[r]=e,{...t,responses:s}}return{...t,responses:[...t.responses,e]}})}}catch(t){O(t instanceof Error?t.message:"Unknown error occurred")}}},[n.config,n.prompts,O]),_=e.useCallback(async()=>{if(n.config)if(0!==n.prompts.length){C(e=>({...e,isLoading:!0,error:null})),$();try{const e=K.map(async e=>{const s=d.createRequest(e.content,n.config);if(!s.success)throw new Error(`Invalid request: ${s.error.message}`);const t=s.data;let r="";try{for await(const s of d.sendStreamingRequest(t))if(s.content&&(r+=s.content,C(o=>{const i=o.responses.findIndex(s=>s.promptId===e.id),a={id:`response-${e.id}`,promptId:e.id,response:{requestId:t.id,content:r,isComplete:s.isComplete,isStreaming:!s.isComplete,metadata:{...void 0!==s.tokenCount&&{tokenCount:s.tokenCount},model:n.config.model,provider:n.config.provider,timestamp:Date.now()}},createdAt:Date.now()};if(i>=0){const e=[...o.responses];return e[i]=a,{...o,responses:e}}return{...o,responses:[...o.responses,a]}})),s.isComplete)break}catch(o){const s={id:`response-${e.id}`,promptId:e.id,response:{requestId:t.id,content:"",isComplete:!0,isStreaming:!1,error:{code:"STREAMING_ERROR",message:o instanceof Error?o.message:"Unknown streaming error",retryable:!0},metadata:{model:n.config.model,provider:n.config.provider,timestamp:Date.now()}},createdAt:Date.now()};C(t=>{const r=t.responses.findIndex(s=>s.promptId===e.id);if(r>=0){const e=[...t.responses];return e[r]=s,{...t,responses:e}}return{...t,responses:[...t.responses,s]}})}});await Promise.allSettled(e)}catch(e){O(e instanceof Error?e.message:"Unknown error occurred")}finally{C(e=>({...e,isLoading:!1}))}}else O("No prompts to send");else O("No LLM configuration available")},[n.config,n.prompts,O,$]),K=e.useMemo(()=>n.prompts.filter(e=>e.content.trim().length>0),[n.prompts]),z=e.useMemo(()=>({...n,actions:{addPrompt:A,updatePrompt:D,removePrompt:R,clearPrompts:q,setConfig:T,updateUIState:M,sendPrompts:_,sendSinglePrompt:U,clearResponses:$,setError:O}}),[n,A,D,R,q,T,M,_,U,$,O]);return t.jsx("div",{className:"min-h-screen bg-background text-foreground",children:t.jsxs("div",{className:"w-full px-2 py-2",children:[t.jsxs("header",{className:"mb-2",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("div",{className:"flex items-center space-x-4",children:t.jsx("h1",{className:"text-4xl font-bold",children:"Juxtaprompt"})}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(f,{theme:L,resolvedTheme:I,onToggle:S}),t.jsx(g,{onClick:()=>E(!0),variant:"ghost",size:"icon",title:"Open settings","aria-label":"Open settings",children:t.jsx(r,{className:"h-4 w-4"})})]})]}),t.jsx("p",{className:"text-muted-foreground text-center text-sm",children:"Professional prompt comparison tool with real-time streaming responses"})]}),t.jsxs("main",{children:[!z.config&&t.jsxs(h,{className:"mb-6",children:[t.jsx("div",{className:"text-yellow-600",children:"⚠️"}),t.jsxs(x,{children:[t.jsx("h3",{className:"font-medium mb-1",children:"Configuration Required"}),t.jsx("p",{className:"text-sm",children:"Please configure an LLM provider to start comparing prompts. Add your API key in the settings panel."})]})]}),z.error&&t.jsxs(h,{variant:"destructive",className:"mb-6",children:[t.jsx("div",{className:"text-destructive",children:"❌"}),t.jsxs(x,{children:[t.jsx("h3",{className:"font-medium mb-1",children:"Error"}),t.jsx("p",{className:"text-sm",children:z.error}),t.jsx(g,{onClick:()=>O(null),variant:"link",size:"sm",className:"mt-2 h-auto p-0 text-xs text-destructive hover:underline",children:"Dismiss"})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("div",{className:"text-sm text-muted-foreground",children:[z.prompts.length," prompt",1!==z.prompts.length?"s":""," •",z.responses.length," response",1!==z.responses.length?"s":""]}),z.config&&t.jsxs(v,{variant:"secondary",className:"text-xs",children:[z.config.provider," • ",z.config.model]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[K.length>0&&z.config&&t.jsx(g,{onClick:_,disabled:z.isLoading,className:"bg-green-600 hover:bg-green-700",children:z.isLoading?"Sending...":"Send All Prompts"}),z.responses.length>0&&t.jsx(g,{onClick:$,disabled:z.isLoading,variant:"secondary",children:"Clear Responses"})]})]}),t.jsx(c,{prompts:z.prompts,responses:z.responses,onPromptChange:D,onPromptRemove:R,onPromptAdd:A,onSendSinglePrompt:U,isLoading:z.isLoading,config:z.config,uiState:z.ui})]})]}),t.jsx(j,{open:P,onOpenChange:E,children:t.jsxs(y,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[t.jsxs(b,{children:[t.jsx(w,{children:"Settings"}),t.jsx(k,{children:"Configure your application preferences including theme and LLM settings."})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-medium mb-4",children:"Theme"}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Choose your preferred theme"}),t.jsx(f,{theme:L,resolvedTheme:I,onToggle:S})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-medium mb-4",children:"LLM Configuration"}),t.jsx(s.Suspense,{fallback:t.jsx("div",{className:"flex items-center justify-center p-8",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}),children:t.jsx(N,{config:z.config,onConfigChange:T})})]})]})]})})]})})};n.createRoot(document.getElementById("root")).render(t.jsx(s.StrictMode,{children:t.jsx(P,{})}));
//# sourceMappingURL=index-c3138a2a.js.map
